diff -Nru mc-4.5.44/vfs/extfs/rpm mc-4.5.44.new/vfs/extfs/rpm
--- mc-4.5.44/vfs/extfs/rpm	Fri Apr  7 05:58:19 2000
+++ mc-4.5.44.new/vfs/extfs/rpm	Fri Apr  7 05:55:44 2000
+++ rpm	Sun Apr 22 09:41:18 2001
@@ -35,7 +35,11 @@
     echo "-r-xr-xr-x   1 root     root    39 $DATE INSTALL"
     echo "-r-xr-xr-x   1 root     root    39 $DATE UPGRADE"
     echo "dr-xr-xr-x   3 root     root	   0 $DATE INFO"
-    echo "$FILEPREF 0 $DATE INFO/NAME-VERSION-RELEASE"
+    test "`rpm -qp --qf \"%{SERIAL}\" \"$1\"`" = "(none)" ||
+	 echo "$FILEPREF 0 $DATE INFO/NAME-SERIAL:VERSION-RELEASE"
+    else
+	echo "$FILEPREF 0 $DATE INFO/NAME-VERSION-RELEASE"
+    fi
     echo "$FILEPREF 0 $DATE INFO/GROUP"
     echo "$FILEPREF 0 $DATE INFO/BUILDHOST"
     echo "$FILEPREF 0 $DATE INFO/SOURCERPM"
@@ -116,7 +120,7 @@
         echo "$FILEPREF 0 $DATE INFO/CHANGELOG"
     fi
 
-    rpm -qlvp "$1" | sed -e 's/^\(..........\)[-t]* /\1 1 /'
+    rpm -qlvp "$1" | sed -e 's/^\(..........\)[-t]* /\1 /'
     echo "$FILEPREF 0 $DATE CONTENTS.cpio"
 }
 
@@ -127,7 +131,10 @@
 	INSTALL) echo "# Run this to install this RPM package" > "$3"; exit 0;;
 	UPGRADE) echo "# Run this to upgrade this RPM package" > "$3"; exit 0;;
 	ERROR) rpm -qip "$1" > /dev/null 2> "$3"; exit 0;;
-	INFO/NAME-VERSION-RELEASE)	rpm -qp --qf "%{NAME}-%{VERSION}-%{RELEASE}\n" "$1" > "$3"; exit 0;;
+	INFO/NAME-VERSION-RELEASE) \
+		rpm -qp --qf "%{NAME}-%{VERSION}-%{RELEASE}\n" "$1" > "$3"; exit 0;;
+	INFO/NAME-SERIAL:VERSION-RELEASE) \
+		rpm -qp --qf "%{NAME}-%{SERIAL}:%{VERSION}-%{RELEASE}\n" "$1" > "$3"; exit 0;;
 	INFO/RELEASE)		rpm -qp --qf "%{RELEASE}\n" "$1" > "$3"; exit 0;;
 	INFO/GROUP)		rpm -qp --qf "%{GROUP}\n" "$1" > "$3"; exit 0;;
 	INFO/DISTRIBUTION) 	rpm -qp --qf "%{DISTRIBUTION}\n" "$1" > "$3"; exit 0;;
@@ -149,8 +156,10 @@
 	INFO/SCRIPTS/POSTIN)	rpm -qp --qf "%{RPMTAG_POSTIN}\n" "$1" >"$3"; exit 0;;
 	INFO/SCRIPTS/PREUN)	rpm -qp --qf "%{RPMTAG_PREUN}\n" "$1" >"$3"; exit 0;;
 	INFO/SCRIPTS/POSTUN)	rpm -qp --qf "%{RPMTAG_POSTUN}\n" "$1" >"$3"; exit 0;;
-	INFO/SCRIPTS/VERIFYSCRIPT)	rpm -qp --qf "%{VERIFYSCRIPT}\n" "$1" >"$3"; exit 0;;
-	INFO/SCRIPTS/TRIGGERSCRIPTS)	rpm -qp --triggers "$1" > "$3"; exit 0;;
+	INFO/SCRIPTS/VERIFYSCRIPT) \
+		rpm -qp --qf "%{VERIFYSCRIPT}\n" "$1" >"$3"; exit 0;;
+	INFO/SCRIPTS/TRIGGERSCRIPTS) \
+		rpm -qp --triggers "$1" > "$3"; exit 0;;
 	INFO/SCRIPTS/ALL)		rpm -qp --scripts "$1" > "$3"; exit 0;;
 	INFO/SUMMARY)		rpm -qp --qf "%{SUMMARY}\n" "$1" > "$3"; exit 0;;
 	INFO/OS)		rpm -qp --qf "%{OS}\n" "$1" > "$3"; exit 0;;
